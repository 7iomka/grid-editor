!function(a){a.fn.gridEditor=function(b){var c=this;return c.each(function(c,d){function e(){y=d.addClass("ge-canvas"),B=a('<textarea class="ge-html-output"/>').insertBefore(y),z=a('<div class="ge-mainControls" />').insertBefore(B);var b=a('<div class="ge-wrapper ge-top" />').appendTo(z);A=a('<div class="ge-addRowGroup btn-group" />').appendTo(b),a.each(C.new_row_layouts,function(b,c){var d=a('<a class="btn btn-xs btn-primary" />').attr("title","Add row "+c.join("-")).on("click",function(){var a=r().appendTo(y);c.forEach(function(b){s(b).appendTo(a)}),f()}).appendTo(A);d.append('<span class="glyphicon glyphicon-plus-sign"/>');var e=(c.join(" - "),'<div class="row ge-row-icon">');c.forEach(function(a){e+='<div class="column col-xs-'+a+'"/>'}),e+="</div>",d.append(e)});var c=a('<div class="dropdown pull-right ge-layout-mode"><button type="button" class="btn btn-xs btn-primary dropdown-toggle" data-toggle="dropdown"><span>Desktop</span></button><ul class="dropdown-menu" role="menu"><li><a data-width="auto" title="Desktop"><span>Desktop</span></a></li><li><a title="Tablet"><span>Tablet</span></li><li><a title="Phone"><span>Phone</span></a></li></ul></div>').on("click","a",function(){var b=a(this);w(b.closest("li").index());var d=c.find("button");d.find("span").remove(),d.append(b.find("span").clone())}).appendTo(b),e=a('<div class="btn-group pull-right"/>').appendTo(b),h=a('<button title="Edit Source Code" type="button" class="btn btn-xs btn-primary gm-edit-mode"><span class="glyphicon glyphicon-chevron-left"></span><span class="glyphicon glyphicon-chevron-right"></span></button>').on("click",function(){h.hasClass("active")?(y.empty().html(B.val()).show(),f(),B.hide()):(g(),B.height(.8*a(window).height()).val(y.html()).show(),y.hide()),h.toggleClass("active btn-danger")}).appendTo(e),i=a('<button title="Preview" type="button" class="btn btn-xs btn-primary gm-preview"><span class="glyphicon glyphicon-eye-open"></span></button>').on("mouseenter",function(){y.removeClass("ge-editing")}).on("click",function(){i.toggleClass("active btn-danger").trigger("mouseleave")}).on("mouseleave",function(){i.hasClass("active")||y.addClass("ge-editing")}).appendTo(e),j=a(window);j.on("scroll",function(){j.scrollTop()>z.offset().top&&j.scrollTop()<y.offset().top+y.height()?b.hasClass("ge-top")&&b.css({left:b.offset().left,width:b.outerWidth()}).removeClass("ge-top").addClass("ge-fixed"):b.hasClass("ge-fixed")&&b.css({left:"",width:""}).removeClass("ge-fixed").addClass("ge-top")}),y.on("click",".ge-content",function(){var b=x(a(this).data("ge-content-type"));b&&b.init(C,a(this))})}function f(){y.addClass("ge-editing"),l(),t(),h(),i(),p(),w(E)}function g(){y.removeClass("ge-editing");y.find(".ge-content").each(function(){var b=a(this);x(b.data("ge-content-type")).deinit(C,b)});y.find(".ge-tools-drawer").remove(),q()}function h(){y.find(".row").each(function(){var b=a(this);if(!b.find("> .ge-tools-drawer").length){var c=a('<div class="ge-tools-drawer" />').prependTo(b);j(c,"Move","ge-move","glyphicon-move"),j(c,"Settings","","glyphicon-cog",function(){d.toggle()}),C.row_tools.forEach(function(a){j(c,a.title||"",a.className||"",a.iconClass||"glyphicon-wrench",a.on)}),j(c,"Remove row","","glyphicon-trash",function(){b.slideUp(function(){b.remove()})}),j(c,"Add column","ge-add-column","glyphicon-plus-sign",function(){b.append(s(3)),f()});var d=k(b,C.row_classes).appendTo(c)}})}function i(){y.find(".column").each(function(){var b=a(this);if(!b.find("> .ge-tools-drawer").length){var c=a('<div class="ge-tools-drawer" />').prependTo(b);j(c,"Move","ge-move","glyphicon-move"),j(c,"Make column narrower\n(hold shift for min)","ge-decrease-col-width","glyphicon-minus",function(a){var c=D[E],d=m(b,c)-1;a.shiftKey&&(d=1),o(b,c,Math.max(d,1))}),j(c,"Make column wider\n(hold shift for max)","ge-increase-col-width","glyphicon-plus",function(a){var c=D[E],d=m(b,c)+1;a.shiftKey&&(d=F),o(b,c,Math.min(d,F))}),j(c,"Settings","","glyphicon-cog",function(){d.toggle()}),C.col_tools.forEach(function(a){j(c,a.title||"",a.className||"",a.iconClass||"glyphicon-wrench",a.on)}),j(c,"Remove col","","glyphicon-trash",function(){b.animate({opacity:"hide",width:"hide",height:"hide"},400,function(){b.remove()})}),j(c,"Add row","ge-add-row","glyphicon-plus-sign",function(){var a=r();b.append(a),a.append(s(6)).append(s(6)),f()});var d=k(b,C.col_classes).appendTo(c)}})}function j(b,c,d,e,f){var g=a('<a title="'+c+'" class="'+d+'"><span class="glyphicon '+e+'"></span></a>').appendTo(b);"function"==typeof f&&g.on("click",f),"object"==typeof f&&a.each(f,function(a,b){g.on(a,b)})}function k(b,c){var d=a('<div class="ge-details" />');a('<input class="ge-id" />').attr("placeholder","id").val(b.attr("id")).attr("title","Set a unique identifier").appendTo(d);var e=a('<div class="btn-group" />').appendTo(d);return c.forEach(function(c){var d=a('<a class="btn btn-xs btn-default" />').html(c.label).attr("title",c.title?c.title:'Toggle "'+c.label+'" styling').toggleClass("active btn-primary",b.hasClass(c.cssClass)).on("click",function(){d.toggleClass("active btn-primary"),b.toggleClass(c.cssClass,d.hasClass("active"))}).appendTo(e)}),d}function l(){y.find('.column, div[class*="col-"]').each(function(){var b=a(this),c=2,d=n(b);d.length&&(c=d[0].size);var e=b.attr("class");D.forEach(function(a){-1==e.indexOf(a)&&b.addClass(a+c)}),b.addClass("column")})}function m(a,b){for(var c=n(a),d=0;d<c.length;d++)if(c[d].colClass==b)return c[d].size;return c.length?c[0].size:null}function n(a){var b=[];return D.forEach(function(c){var d=new RegExp(c+"(\\d+)","i");d.test(a.attr("class"))&&b.push({colClass:c,size:parseInt(d.exec(a.attr("class"))[1])})}),b}function o(a,b,c){var d=new RegExp("("+b+"(\\d+))","i"),e=d.exec(a.attr("class"));e&&parseInt(e[2])!==c?a.switchClass(e[1],b+c,50):a.addClass(b+c)}function p(){function a(a,b){b.placeholder.css({height:b.item.outerHeight()}),b.helper.hide()}y.find(".row").sortable({items:"> .column",connectWith:".ge-canvas .row",handle:"> .ge-tools-drawer .ge-move",start:a,helper:"clone"}),y.add(y.find(".column")).sortable({items:"> .row, > .ge-content",connectsWith:".ge-canvas, .ge-canvas .column",handle:"> .ge-tools-drawer .ge-move",start:a,helper:"clone"})}function q(){y.add(y.find(".column")).add(y.find(".row")).sortable("destroy")}function r(){return a('<div class="row" />')}function s(b){return a("<div/>").addClass(D.map(function(a){return a+=b}).join(" ")).append(v().html(x(C.content_types[0]).initialContent))}function t(){y.find(".column").each(function(){var b=a(this),c=a();b.children().each(function(){var b=a(this);b.is(".row, .ge-tools-drawer, .ge-content")?u(c):c=c.add(b)}),u(c)})}function u(b){if(b.length){var c=v().insertAfter(b.last());b.appendTo(c),b=a()}}function v(){return a("<div/>").addClass("ge-content ge-content-type-"+C.content_types[0]).attr("data-ge-content-type",C.content_types[0])}function w(a){E=a;var b=["ge-layout-desktop","ge-layout-tablet","ge-layout-phone"];b.forEach(function(b,c){y.toggleClass(b,c==a)})}function x(b){return a.fn.gridEditor.RTEs[b]}d=a(d);var y,z,A,B,C=a.extend({new_row_layouts:[[12],[6,6],[4,4,4],[3,3,3,3],[2,2,2,2,2,2],[2,8,2],[4,8],[8,4]],row_classes:[{label:"Example class",cssClass:"example-class"}],col_classes:[{label:"Example class",cssClass:"example-class"}],col_tools:[],row_tools:[],content_types:["tinymce"]},b),D=["col-md-","col-sm-","col-xs-"],E=0,F=12;e(),f(),d.data("grideditor",{init:f,deinit:g})}),c},a.fn.gridEditor.RTEs={}}(jQuery),function(){$.fn.gridEditor.RTEs.tinymce={init:function(a,b){window.tinymce||console.error("tinyMCE not available! Make sure you loaded the tinyMCE js file."),b.tinymce||console.error("tinyMCE jquery integration not available! Make sure you loaded the jquery integration plugin.");var c=this;b.each(function(){var b=$(this);if(!b.hasClass("active")){b.html()==c.initialContent&&b.html(""),b.addClass("active");var d=b.tinymce(a.tinymce&&a.tinymce.config||{inline:!0});setTimeout(function(){d.focus()})}})},deinit:function(a,b){b.filter(".active").each(function(){var a=$(this),b=a.tinymce();b&&b.remove(),a.removeClass("active").attr("id",null).attr("style",null).attr("spellcheck",null)})},initialContent:"<p>Lorem ipsum dolores</p>"}}();
//# sourceMappingURL=jquery.grideditor.min.js.map